---
title: "正規表現10本ノック6本目" # 記事のタイトル
emoji: "📝" # アイキャッチとして使われる絵文字（1文字だけ）
type: "tech" # tech: 技術記事 / idea: アイデア記事
topics: [regexp] # タグ。["markdown", "rust", "aws"]のように指定する
published: false # 公開設定（falseにすると下書き）
---
# 出題：正規表現10本ノック6本目(メタ文字 `()`)

## 背景

あなたはプログラマです。あきもせず何もしないプログラムを見ています。そして気づきます。また壊れてる・・・

```vb
  Dim foo as Long
  Dim babababar as Long
  Dim babababaz as Long
```

## お題
以下の文字列のうち、○の文字列にマッチして×の文字列にマッチしない正規表現を考えてください。
（冒頭の背景のことは無視してください。置換のことは考えなくて良いです)

    ×: foo
    ○: babababar
    ○: babababaz
    ×: r
    ×: z

使用する正規表現の条件:
  * 文字数の目安: 10文字(メタ文字 `()`, `+`, `.` を使用)
  * 文字数の目安: 9〜10文字(メタ文字 `()`, `+` を使用、`.` を使用しない)

## 回答と解説

:::details 回答
`(ba)+.`
:::

:::details 回答(中級者向け)
`(ba)+[rz]` または、`(ba)+(r|z)`
:::

:::details 解説
前回、ノック5本目で繰り返しを学びました。そこで `+` や `*` は「直前の正規表現」を繰り返すと説明しました。改めてこの意味を説明します。

`foo*` と書いた時は `f` `o` `o` `*` の各文字の中で `o` と `*` の並びの結合が強いことになっています。
算数で言うと `fo(o*)` と言う意味になります。この算数で言う`()`の使い方が正規表現でも使えます。 `fo(o*)` は正しい正規表現で、`foo*` と実質同じ意味になっています。このことに関して、メタ文字 `*` は優先順位が高いとも言います。

では、`(fo)o*` と書くとどうなるでしょうか？これは `(fo)(o*)` と同じで、`foo*` とも同じです。

では、`(f)oo*` と書くとどうなるでしょうか？これも `foo*` と同じです。

では、`(foo)*` と書くとどうなるでしょうか？これは `*` が指す「直前の正規表現」が
`foo` であるという意味になります。つまり、(foo)* は

* 空文字列 (fooの0回の繰り返し)
* foo  (foo1回の繰り返し)
* foofoo  (foo2回の繰り返し)
* foofoofoo  (foo3回の繰り返し)
* 以降、無限に続く…

にマッチする正規表現となります。

`()` を使うと正規表現の表現力が広がります。これらを応用して問題を解いてみてください。
少し問題の難易度が上がってきましたね。
:::

:::details 解説（中級者向け）
優先順位の話を続けます。今まで、`bar|baz` と言う正規表現を使っていました。
これは`()`で優先順位を明記すると、`(bar)|(baz)` の意味になります。
メタ文字 `|` の優先順位は文字の並び `bar` などよりも低いと言えます。

まとめると、正規表現の優先順位は括弧を使わない場合、

    繰り返し(`*`, `+`) ＞ 文字の並び ＞ 選択(`|`)

の順番になっています。`bar|baz` を `ba(r|b)az` と変更するとこれは、`baraz` または `babaz` のいずれかにマッチする正規表現に意味が変わります。優先順位の解釈は正規表現を書く上で大事なことです。

改めて、`()` は正規表現の優先順位を変更するためのメタ文字です。また、`()`で正規表現を囲むことをグルーピングと言います。グルーピングには優先順位の変更以外にも役割がありますが、このことについてはここでは説明しません。
:::
